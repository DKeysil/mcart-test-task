# mcart python backend test task

### ТЗ:
Реализовать микросервис, который будет предоставлять http api, для показа разницы курса той или иной валюты относительно рубля за выбранные даты.

### Ход работы: 

#### Получение данных
Для получения курсов валют использовался [API](http://www.cbr.ru/development/sxml/), который принимал две даты и возвращал XML документ, содержащий ежедневные курсы валют в рублях между двумя датами.

Список доступных валют был получен [отсюда](http://www.cbr.ru/scripts/XML_valFull.asp). Не все валюты могли быть использованы в API, поэтому лишние были удалены. В репозитории лежит файл с актуальным списком.

#### Микросервис
Для написания микросервиса использовался веб-фреймворк aiohttp, из-за асинхронности и актуальности.

Для обработки запросов от фронтенда была использована библиотека `aiohttp_cors` для настройки cors политики.

После запуска приложения сразу открывается список доступных валют, обрабатывается в список и хранится в оперативной памяти, для дальнейшего использования. Для обработки XML структуры используется стандартная библиотека.

Сервис предоставляет два метода:
1) Список доступных валют в формате (символьный код (RUR), название). `/api/currency_list`
2) Получение разницы курса относительно рубля между двумя датами за выбранную дату, метод должен принимать символьный код валюты, и две даты. Метод возвращает курс за первую дату, курс за вторую дату и разницу между ними.
`/api/exchange_rate_difference?symb=symb&date_req1=date&date_req2=date`
Если пользователь указывает неверные аргументы или валюта не будет найдено, то пользователь получит соответствующую ошибку.

### Запуск:
Для установки тествого виртуального окружения выполните следующие команды:
```sh
python3 -m venv venv
. venv/bin/activate
pip install -r requirements.txt
```

Для запуска:
```sh
python __main__.py
```

## Тесткейсы:
Получение списка валют:
```sh
curl http://127.0.0.1:8080/api/currency_list
```
Должен вернуть:
```json
[["AUD", "Австралийский доллар"], ["AZN", "Азербайджанский манат"], ["GBP", "Фунт стерлингов Соединенного королевства"], ["AMD", "Армянский драм"], ["BYN", "Белорусский рубль"], ["BGN", "Болгарский лев"], ["BRL", "Бразильский реал"], ["HUF", "Венгерский форинт"], ["HKD", "Гонконгский доллар"], ["DKK", "Датская крона"], ["USD", "Доллар США"], ["EUR", "Евро"], ["INR", "Индийская рупия"], ["KZT", "Казахстанский тенге"], ["CAD", "Канадский доллар"], ["KGS", "Киргизский сом"], ["CNY", "Китайский юань"], ["MDL", "Молдавский лей"], ["NOK", "Норвежская крона"], ["PLN", "Польский злотый"], ["ROL", "Румынский лей"], ["RON", "Румынский лей"], ["XDR", "СДР (специальные права заимствования)"], ["SGD", "Сингапурский доллар"], ["TJS", "Таджикский сомони"], ["TRY", "Турецкая лира"], ["TMM", "Туркменский манат"], ["TMT", "Новый туркменский манат"], ["UZS", "Узбекский сум"], ["UAH", "Украинская гривна"], ["CZK", "Чешская крона"], ["SEK", "Шведская крона"], ["CHF", "Швейцарский франк"], ["ZAR", "Южноафриканский рэнд"], ["KRW", "Вон Республики Корея"], ["JPY", "Японская иена"]]
```

Получение разницы курса:
```sh
curl "http://127.0.0.1:8080/api/exchange_rate_difference?date_req1=2020-09-15&date_req2=2020-12-15&symb=USD"
```
Должен вернуть:
```json
{"title": "Доллар США", "first_exchange_rate": 74.7148, "second_exchange_rate": 73.1195, "difference": -1.5952999999999946}
```
